function contextService(){var service={targetMenu:null,targetElement:null};return service}function contextMenu($log,$document,$window,contextService){function _link(scope,elem,attrs){function open(target,posX,posY){contextService.targetMenu&&contextService.targetMenu!=$context&&contextService.targetMenu.addClass("ng-hide"),$context.removeClass("ng-hide"),scope.isOpen=!0;var elWidth=$context[0].clientWidth,elHeight=$context[0].clientHeight,docTop=(window.pageYOffset||doc.scrollTop)-(doc.clientTop||0),docLeft=(window.pageXOffset||doc.scrollLeft)-(doc.clientLeft||0);posX+elWidth>=$window.innerWidth&&(posX-=elWidth),posY+elHeight>=$window.innerHeight&&(posY-=elHeight),$context.css("left",posX-docLeft+"px"),$context.css("top",posY-docTop+"px"),contextService.targetElement=elem,contextService.targetMenu=$context}function close(){$context.addClass("ng-hide"),scope.isOpen=!1,contextService.targetMenu=null,contextService.targetElement=null}if(!attrs.contextMenu)return void $log.warn("contextMenu: Empty context menu name on element: ",elem);if(!$document[0].body.contains(document.getElementById(attrs.contextMenu)))return void $log.warn("contextMenu: The context menu id: "+attrs.contextMenu+" does not exist!");var doc=$document[0].documentElement,$context=angular.element(document.getElementById(attrs.contextMenu));$context.css("position","fixed"),$context.addClass("ng-hide"),$context.bind("contextmenu",function(e){e.preventDefault()}),$context.bind("click",function(e){return close()}),elem.on("contextmenu",function(e){e.preventDefault(),open(e.target,e.pageX,e.pageY)}),elem.bind("click",function(e){return close()}),$document.bind("click",function(e){e.target!=contextService.targetMenu&&scope.isOpen&&close()})}var directive={restrict:"A",scope:!1,link:_link};return directive}angular.module("contextMenu",[]),angular.module("contextMenu").service("contextService",contextService),angular.module("contextMenu").directive("contextMenu",contextMenu),contextMenu.$inject=["$log","$document","$window","contextService"];
